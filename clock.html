<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Khatra Clock | Rakesh C.</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            overflow: hidden;
            transition: background-color 1s ease;
        }
        /* Hide scrollbars */
        ::-webkit-scrollbar { display: none; }
        /* Custom Animations */
        @keyframes blob {
            0% { transform: translate(0px, 0px) scale(1); }
            33% { transform: translate(30px, -50px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
            100% { transform: translate(0px, 0px) scale(1); }
        }
    </style>
</head>
<body id="app-body" class="bg-[#050505] min-h-screen flex flex-col items-center justify-center relative">

    <!-- Back Link (Hidden if inside iframe) -->
    <a href="index.html" class="absolute top-6 right-6 z-50 flex items-center gap-2 text-sm font-bold tracking-widest uppercase transition-all duration-300 group text-white/30 hover:text-white" id="back-link">
        <span>Back to Home</span>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" class="transform transition-transform group-hover:translate-x-1 group-hover:-translate-y-1"><path d="M7 17l9.2-9.2M17 17V7H7" /></svg>
    </a>

    <!-- Background Effects -->
    <div id="bg-neon" class="absolute inset-0 pointer-events-none transition-opacity duration-1000">
        <div class="absolute top-[-20%] left-[-10%] w-[800px] h-[800px] bg-cyan-600/20 rounded-full blur-[120px] animate-pulse"></div>
        <div class="absolute bottom-[-20%] right-[-10%] w-[800px] h-[800px] bg-purple-600/20 rounded-full blur-[120px] animate-pulse animation-delay-700"></div>
        <div class="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-30 mix-blend-overlay"></div>
    </div>

    <div id="bg-royal" class="absolute inset-0 pointer-events-none transition-opacity duration-1000 opacity-0 hidden">
        <div class="absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,_rgba(253,224,71,0.05),transparent_60%)]"></div>
        <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/dark-leather.png')] opacity-30 mix-blend-overlay"></div>
    </div>

    <!-- Main Content -->
    <!-- Removed scale-75 to make it look bigger in the widget -->
    <main class="relative z-10 flex flex-col items-center transform transition-transform duration-500 scale-90 sm:scale-100">
        
        <!-- Analog Clock -->
        <div id="clock-face" class="relative w-[300px] h-[300px] sm:w-[350px] sm:h-[350px] rounded-full border-[6px] flex items-center justify-center transition-all duration-700 ease-out bg-black/60 backdrop-blur-2xl border-cyan-500/30 shadow-[0_0_100px_rgba(6,182,212,0.3)]">
            
            <!-- Ticks -->
            <div id="ticks-container" class="absolute inset-0 rounded-full">
                <!-- Generated by JS -->
            </div>

            <!-- Numerals -->
            <div id="numerals-container" class="absolute inset-8">
                <!-- Generated by JS -->
            </div>

            <!-- Hands -->
            <div id="hour-hand-container" class="absolute top-1/2 left-1/2 w-0 h-0 flex justify-center">
                <div id="hour-hand" class="absolute bottom-0 h-16 sm:h-20 rounded-full origin-bottom -translate-y-[10%] bg-cyan-400 w-2 shadow-[0_0_15px_rgba(34,211,238,0.8)]"></div>
            </div>

            <div id="minute-hand-container" class="absolute top-1/2 left-1/2 w-0 h-0 flex justify-center">
                <div id="minute-hand" class="absolute bottom-0 h-24 sm:h-28 rounded-full origin-bottom bg-fuchsia-500 w-1.5 shadow-[0_0_15px_rgba(217,70,239,0.8)]"></div>
            </div>

            <div id="second-hand-container" class="absolute top-1/2 left-1/2 w-0 h-0 flex justify-center">
                <div id="second-hand" class="absolute bottom-[-20px] h-32 sm:h-36 origin-[50%_calc(100%-20px)] bg-white w-0.5 shadow-[0_0_10px_white]"></div>
                <div id="second-hand-counterweight" class="absolute top-5 w-2 h-2 sm:w-3 sm:h-3 rounded-full bg-white"></div>
            </div>

            <!-- Center Pin -->
            <div id="center-pin" class="absolute w-4 h-4 sm:w-6 sm:h-6 rounded-full z-50 left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-white shadow-[0_0_20px_white]"></div>

            <!-- Glare -->
            <div class="absolute inset-0 rounded-full bg-gradient-to-tr from-white/5 via-transparent to-transparent pointer-events-none"></div>
        </div>

        <!-- Digital Display -->
        <div class="flex flex-col items-center mt-6 sm:mt-8 z-20">
            <div id="digital-container" class="flex items-baseline gap-1 font-mono text-cyan-400 drop-shadow-[0_0_10px_rgba(6,182,212,0.8)]">
                <span id="d-hours" class="text-4xl sm:text-5xl font-bold tracking-tight">00</span>
                <span class="text-4xl sm:text-5xl font-bold animate-pulse">:</span>
                <span id="d-minutes" class="text-4xl sm:text-5xl font-bold tracking-tight">00</span>
                <span class="text-2xl sm:text-3xl font-light opacity-80 mx-1">:<span id="d-seconds">00</span></span>
                <span id="d-ms" class="text-lg sm:text-xl font-bold text-fuchsia-400">.00</span>
            </div>
            
            <div id="date-container" class="mt-2 flex items-center gap-3 text-xs sm:text-sm tracking-[0.2em] uppercase text-fuchsia-400 font-semibold">
                <span id="d-day">MONDAY</span>
                <span class="w-1.5 h-1.5 rounded-full bg-current opacity-50"></span>
                <span id="d-date">MONTH 00</span>
                <span class="w-1.5 h-1.5 rounded-full bg-current opacity-50"></span>
                <span id="d-year">0000</span>
            </div>
        </div>

    </main>

    <!-- Theme Switcher -->
    <div class="absolute bottom-4 z-50 flex gap-4 bg-white/5 backdrop-blur-xl border border-white/10 p-2 rounded-full shadow-2xl scale-75 sm:scale-100 origin-bottom">
        <button onclick="setTheme('minimal')" class="p-3 rounded-full transition-all duration-300 transform hover:scale-110 text-white/50 hover:bg-white/10 hover:text-white" id="btn-minimal">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="5"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg>
        </button>
        <button onclick="setTheme('neon')" class="p-3 rounded-full transition-all duration-300 transform hover:scale-110 bg-white text-black shadow-[0_0_15px_rgba(255,255,255,0.5)]" id="btn-neon">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
        </button>
        <button onclick="setTheme('royal')" class="p-3 rounded-full transition-all duration-300 transform hover:scale-110 text-white/50 hover:bg-white/10 hover:text-white" id="btn-royal">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
        </button>
    </div>

    <script>
        // Check if inside iframe
        if (window.self !== window.top) {
            const backLink = document.getElementById('back-link');
            if (backLink) backLink.style.display = 'none';
        }

        // --- 1. SETUP CLOCK FACE (Ticks & Numerals) ---
        const ticksContainer = document.getElementById('ticks-container');
        const numeralsContainer = document.getElementById('numerals-container');
        const romanNumerals = [
            { num: 'XII', val: 0 }, { num: 'I', val: 1 }, { num: 'II', val: 2 },
            { num: 'III', val: 3 }, { num: 'IV', val: 4 }, { num: 'V', val: 5 },
            { num: 'VI', val: 6 }, { num: 'VII', val: 7 }, { num: 'VIII', val: 8 },
            { num: 'IX', val: 9 }, { num: 'X', val: 10 }, { num: 'XI', val: 11 }
        ];

        // Create Ticks
        for (let i = 0; i < 60; i++) {
            const isHour = i % 5 === 0;
            const el = document.createElement('div');
            el.className = `absolute top-0 left-1/2 -translate-x-1/2 origin-[50%_150px] sm:origin-[50%_175px] transition-colors duration-500 tick-mark`;
            // Initial styling for Neon
            el.className += isHour ? ' h-4 sm:h-5 w-1 opacity-100 bg-cyan-600 shadow-[0_0_5px_rgba(6,182,212,0.8)]' : ' h-2 sm:h-2.5 w-0.5 opacity-40 bg-cyan-600';
            el.style.transform = `rotate(${i * 6}deg)`;
            ticksContainer.appendChild(el);
        }

        // Create Numerals
        romanNumerals.forEach((item, i) => {
            const angle = i * 30;
            const wrapper = document.createElement('div');
            wrapper.className = 'absolute w-full h-full left-0 top-0 text-center';
            wrapper.style.transform = `rotate(${angle}deg)`;
            
            const span = document.createElement('span');
            span.className = 'inline-block text-xl sm:text-2xl font-bold transition-colors duration-500 numeral-text text-cyan-400 font-mono drop-shadow-[0_0_8px_rgba(34,211,238,0.8)]';
            span.style.transform = `rotate(-${angle}deg)`;
            span.textContent = item.num;
            
            wrapper.appendChild(span);
            numeralsContainer.appendChild(wrapper);
        });

        // --- 2. THEME LOGIC ---
        const themes = {
            neon: {
                bg: 'bg-[#050505]',
                face: 'bg-black/60 backdrop-blur-2xl border-cyan-500/30 shadow-[0_0_100px_rgba(6,182,212,0.3)]',
                tickHour: 'bg-cyan-600 shadow-[0_0_5px_rgba(6,182,212,0.8)]',
                tickMin: 'bg-cyan-600',
                numeral: 'text-cyan-400 font-mono drop-shadow-[0_0_8px_rgba(34,211,238,0.8)]',
                hourHand: 'bg-cyan-400 w-2 shadow-[0_0_15px_rgba(34,211,238,0.8)]',
                minHand: 'bg-fuchsia-500 w-1.5 shadow-[0_0_15px_rgba(217,70,239,0.8)]',
                secHand: 'bg-white w-0.5 shadow-[0_0_10px_white]',
                pin: 'bg-white shadow-[0_0_20px_white]',
                digiMain: 'text-cyan-400 drop-shadow-[0_0_10px_rgba(6,182,212,0.8)]',
                digiSub: 'text-fuchsia-400',
                backLink: 'text-white/30 hover:text-white',
                elements: { neonBg: true, royalBg: false, counterWeight: true }
            },
            minimal: {
                bg: 'bg-gray-100',
                face: 'bg-white border-gray-300 shadow-[0_0_60px_rgba(0,0,0,0.1)]',
                tickHour: 'bg-gray-800',
                tickMin: 'bg-gray-800',
                numeral: 'text-gray-900 font-sans drop-shadow-none',
                hourHand: 'bg-gray-900 w-2 shadow-none',
                minHand: 'bg-gray-600 w-1.5 shadow-none',
                secHand: 'bg-red-500 w-0.5 shadow-none',
                pin: 'bg-red-500 border-2 border-white shadow-none',
                digiMain: 'text-gray-900 drop-shadow-none',
                digiSub: 'text-gray-500',
                backLink: 'text-gray-400 hover:text-black',
                elements: { neonBg: false, royalBg: false, counterWeight: false }
            },
            royal: {
                bg: 'bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-[#1e293b] via-[#0f172a] to-black',
                face: 'bg-gradient-to-b from-slate-900 to-black border-yellow-600/60 shadow-[0_0_80px_rgba(234,179,8,0.2)]',
                tickHour: 'bg-yellow-700',
                tickMin: 'bg-yellow-700',
                numeral: 'text-yellow-500 font-serif drop-shadow-none',
                hourHand: 'bg-gradient-to-t from-yellow-600 to-yellow-300 w-3 shadow-lg',
                minHand: 'bg-gradient-to-t from-yellow-700 to-yellow-400 w-2 shadow-lg',
                secHand: 'bg-red-600 w-1 shadow-md',
                pin: 'bg-yellow-400 border-4 border-yellow-900 shadow-none',
                digiMain: 'text-yellow-500 drop-shadow-md',
                digiSub: 'text-yellow-700',
                backLink: 'text-white/30 hover:text-white',
                elements: { neonBg: false, royalBg: true, counterWeight: true }
            }
        };

        function setTheme(name) {
            const t = themes[name];
            
            // Body Background
            document.getElementById('app-body').className = `${t.bg} min-h-screen flex flex-col items-center justify-center relative overflow-hidden transition-colors duration-1000`;
            
            // Clock Face
            document.getElementById('clock-face').className = `relative w-[300px] h-[300px] sm:w-[350px] sm:h-[350px] rounded-full border-[6px] flex items-center justify-center transition-all duration-700 ease-out ${t.face}`;

            // Ticks
            const ticks = document.querySelectorAll('.tick-mark');
            ticks.forEach((tick, i) => {
                const isHour = i % 5 === 0;
                tick.className = `absolute top-0 left-1/2 -translate-x-1/2 origin-[50%_150px] sm:origin-[50%_175px] transition-colors duration-500 tick-mark ${isHour ? 'h-4 sm:h-5 w-1 opacity-100 ' + t.tickHour : 'h-2 sm:h-2.5 w-0.5 opacity-40 ' + t.tickMin}`;
            });

            // Numerals
            const nums = document.querySelectorAll('.numeral-text');
            nums.forEach(n => n.className = `inline-block text-xl sm:text-2xl font-bold transition-colors duration-500 numeral-text ${t.numeral}`);

            // Hands
            document.getElementById('hour-hand').className = `absolute bottom-0 h-16 sm:h-20 rounded-full origin-bottom -translate-y-[10%] transition-all duration-500 ${t.hourHand}`;
            document.getElementById('minute-hand').className = `absolute bottom-0 h-24 sm:h-28 rounded-full origin-bottom transition-all duration-500 ${t.minHand}`;
            document.getElementById('second-hand').className = `absolute bottom-[-20px] h-32 sm:h-36 origin-[50%_calc(100%-20px)] transition-all duration-500 ${t.secHand}`;
            document.getElementById('center-pin').className = `absolute w-4 h-4 sm:w-6 sm:h-6 rounded-full z-50 left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 transition-all duration-500 ${t.pin}`;

            // Digital & Link
            document.getElementById('digital-container').className = `flex items-baseline gap-1 font-mono transition-colors duration-500 ${t.digiMain}`;
            document.getElementById('d-ms').className = `text-lg sm:text-xl font-bold transition-colors duration-500 ${t.digiSub}`;
            document.getElementById('date-container').className = `mt-2 flex items-center gap-3 text-xs sm:text-sm tracking-[0.2em] uppercase font-semibold transition-colors duration-500 ${t.digiSub}`;
            document.getElementById('back-link').className = `absolute top-6 right-6 z-50 flex items-center gap-2 text-sm font-bold tracking-widest uppercase transition-all duration-300 group ${t.backLink}`;

            // Elements Visibility
            const bgNeon = document.getElementById('bg-neon');
            const bgRoyal = document.getElementById('bg-royal');
            const counterWeight = document.getElementById('second-hand-counterweight');

            bgNeon.style.opacity = t.elements.neonBg ? '1' : '0';
            bgRoyal.classList.toggle('hidden', !t.elements.royalBg);
            if(t.elements.royalBg) setTimeout(() => bgRoyal.style.opacity = '1', 10);
            else bgRoyal.style.opacity = '0';
            
            counterWeight.style.display = t.elements.counterWeight ? 'block' : 'none';
            if (t.elements.counterWeight) {
                counterWeight.className = `absolute top-5 w-2 h-2 sm:w-3 sm:h-3 rounded-full ${t.secHand.split(' ')[0]}`; // use same color as hand
            }

            // Buttons State
            document.querySelectorAll('button').forEach(btn => {
                btn.className = "p-3 rounded-full transition-all duration-300 transform hover:scale-110 text-white/50 hover:bg-white/10 hover:text-white";
                if(btn.id === `btn-${name}`) {
                    const activeClass = name === 'minimal' 
                        ? 'bg-white text-black shadow-lg scale-110'
                        : name === 'neon'
                            ? 'bg-cyan-500 text-black shadow-lg shadow-cyan-500/50 scale-110'
                            : 'bg-yellow-500 text-black shadow-lg shadow-yellow-500/50 scale-110';
                    btn.className = `p-3 rounded-full transition-all duration-300 transform ${activeClass}`;
                }
            });
        }

        // --- 3. CLOCK LOGIC ---
        function updateClock() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes();
            const seconds = now.getSeconds();
            const milliseconds = now.getMilliseconds();

            // Analog Calculations
            const secondRatio = seconds + milliseconds / 1000;
            const minuteRatio = minutes + secondRatio / 60;
            const hourRatio = (hours % 12) + minuteRatio / 60;

            document.getElementById('second-hand-container').style.transform = `rotate(${secondRatio * 6}deg)`;
            document.getElementById('minute-hand-container').style.transform = `rotate(${minuteRatio * 6}deg)`;
            document.getElementById('hour-hand-container').style.transform = `rotate(${hourRatio * 30}deg)`;

            // Digital Display
            const pad = (n) => n.toString().padStart(2, '0');
            const padMs = (n) => n.toString().padStart(3, '0').substring(0, 2);

            document.getElementById('d-hours').textContent = pad(hours);
            document.getElementById('d-minutes').textContent = pad(minutes);
            document.getElementById('d-seconds').textContent = pad(seconds);
            document.getElementById('d-ms').textContent = '.' + padMs(milliseconds);

            // Date (Optimized to not update every frame if not needed, but safe here)
            document.getElementById('d-day').textContent = now.toLocaleString('default', { weekday: 'long' });
            document.getElementById('d-date').textContent = now.toLocaleString('default', { month: 'long' }) + ' ' + now.getDate();
            document.getElementById('d-year').textContent = now.getFullYear();

            requestAnimationFrame(updateClock);
        }

        // Start
        requestAnimationFrame(updateClock);
        setTheme('neon'); // Default Theme
    </script>
</body>
</html>
